!function(){"use strict";function h(e){return 0<=(e=e.replace(/"/g,'""')).search(/("|,|\n|:)/g)&&(e='"'+e+'"'),e}var n={exportTable:function(e,t){var o,r,n,l,a,c,i,s,d,u,p=document.querySelector(e),v=[],f=[];for(t=t||"Report.csv",r=0,n=(o=p.tHead.rows[0]).cells.length;r<n;r++)f.push(h(o.cells[r].textContent));for(v.push(f.join(",")),a=0,c=(l=p.tBodies[0].rows).length;a<c;a++){for(f=[],r=0,n=(o=l[a]).cells.length;r<n;r++)f.push(h(o.cells[r].textContent));v.push(f.join(","))}if(i=v.join("\r\n"),s=new Blob([i],{type:"text/csv; charset=utf-8;"}),void 0!==navigator.msSaveBlob)navigator.msSaveBlob(s,t);else if(void 0!==(d=document.createElement("a")).download)u=URL.createObjectURL(s),d.setAttribute("href",u),d.setAttribute("download",t),d.style.visibility="hidden",document.body.appendChild(d),d.click(),document.body.removeChild(d);else{app.showErrorAlert("Unable to Export as a CSV File. Try a different browser and if you need help then please contact support.")}},onRendered:function(){var e=document.querySelectorAll("[data-export-csv-selector]"),r=!1;if(0<e.length){var t=document.querySelector("a");null===t&&(t=document.createElement("a")),r=void 0!==navigator.msSaveBlob||void 0!==t.download}Array.prototype.forEach.call(e,function(e){if(r){var t=e.getAttribute("data-export-csv-selector"),o=e.getAttribute("data-export-file-name");e.onclick=function(){n.exportTable(t,o)}}else e.style.display="none"})}};app.addPlugin("exportToCsv",n)}();