export default class I18n{constructor(e,t,a="_",n="i18n"){if("string"!=typeof e)throw new Error("Error - I18n - Missing default locale See examples for usage.");if(!Array.isArray(t))throw new Error("Error - I18n - Missing or invalid supported locales. See examples for usage.");this.state={fileName:a,fileDir:n,defaultLocale:e,supportedLocales:t,currentLocale:null,langText:{},langCache:{},startCallback:null,loadedCallback:null},window.addEventListener("hashchange",this.onHashChange.bind(this)),this.onHashChange()}onLangStart(e){this.state.startCallback=e}onLangLoaded(e){this.state.loadedCallback=e}get currentLocale(){return this.state.currentLocale}get getUserDefaultLang(){if(navigator.languages&&navigator.languages.length&&this.state.supportedLocales&&this.state.supportedLocales.length)for(let e=0,t=navigator.languages.length;e<t;e++)if(-1!==this.state.supportedLocales.indexOf(navigator.languages[e]))return navigator.languages[e];return this.state.defaultLocale}onHashChange(){const e=this,t=this.state;let a=null;if(0===window.location.hash.indexOf("#/")&&(""!==(a=window.location.hash.split("/")[1])&&-1!==t.supportedLocales.indexOf(a)||(a=null)),null===a&&(a=t.defaultLocale),t.currentLocale===a)return;t.currentLocale=a,this.state.startCallback&&this.state.startCallback();const n=t.fileDir+"/"+t.fileName+"."+t.currentLocale+".json";void 0!==t.langCache[n]?(t.langText=t.langCache[n],e.updatePageTitle(),t.loadedCallback&&t.loadedCallback()):fetch(n,{mode:"cors",cache:"no-store",credentials:"same-origin"}).then(function(e){const t=e.status;if(t>=200&&t<300||304===t)return Promise.resolve(e);{const a="Error loading data. Server Response Code: "+t+", Response Text: "+e.statusText;return Promise.reject(a)}}).then(function(e){return e.json()}).then(function(e){t.langCache[n]=e}).catch(function(e){const a="Error Downloading I18N file: ["+n+"], Response Code Status: "+e.message;console.error(a),t.langCache[n]={}}).finally(function(){t.langText=t.langCache[n],e.updatePageTitle(),t.loadedCallback&&t.loadedCallback()})}updatePageTitle(){var e=document.querySelector("html title[data-i18n]");e&&(e.textContent=this.text(e.getAttribute("data-i18n"))),document.documentElement.lang=this.state.currentLocale}text(e){return this.state.langText&&this.state.langText[e]?this.state.langText[e]:e}};